/*!
  * vulidator v0.1.0
  */
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(e.vulidator={})}(this,function(e){"use strict";var r={name:"vulidate-error",props:{error:{type:Object,default:function(){return{}}}},render:function(e){if(this.error.message)return e("div",{},[e("div",this.error.message)])}},t={componentUpdated:function(e,r,t){var n=t.context.$vulidator;if(n){var i=n.getScope(e),o=e.name||r.value;n.errorBag.getErrors(i,o).length?e.classList.add("is-invalid"):e.classList.remove("is-invalid");var s=e.parentNode.querySelector(".error-hint");for(s||((s=document.createElement("div")).className="error-hint text-danger w-100 text-left small",e.parentNode.insertBefore(s,e.nextSibling));s.firstChild;)s.removeChild(s.firstChild)}}};function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function i(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,r,t){return r&&i(e.prototype,r),t&&i(e,t),e}var c=function e(r,t,n,i){o(this,e),this.field=r,this.message=t,this.scope=n,this.rule=i},a=function(){function e(){o(this,e),this.errors||(this.errors=[])}return s(e,[{key:"getErrors",value:function(r,t){var e=r?this.errors.filter(function(e){return e.scope===r}):this.errors;return t?e.filter(function(e){return e.field===t}):e}},{key:"getMessages",value:function(r){var e=this.errors.slice(0);return r&&(e=e.filter(function(e){return e.scope===r})),e.map(function(e){return e.message})}},{key:"clear",value:function(r){var e=this.errors.slice(0);this.errors=r?e.filter(function(e){return e.scope!==r}):[]}},{key:"has",value:function(r,t){var e=this.errors.slice(0);return t&&(e=e.filter(function(e){return e.scope===t})),e.filter(function(e){return e.field===r}).length}},{key:"replace",value:function(r,e){var t=this.errors.filter(function(e){return e.scope!==r});this.clear(),this.append(t),this.append(e)}},{key:"append",value:function(e){var r=Array.isArray(e)?e:[e],t=!0,n=!1,i=void 0;try{for(var o,s=r.slice(0)[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var a=o.value;this.errors.push(a)}}catch(a){n=!0,i=a}finally{try{t||null==s.return||s.return()}finally{if(n)throw i}}}},{key:"count",value:function(){return this.errors.length}},{key:"first",value:function(){return this.errors.length?this.errors[0]:null}},{key:"any",value:function(e){return Boolean(this.getErrors(e).length)}}]),e}(),h=function(){function n(e,r,t){o(this,n),this.form=e,this.el=r,this.data=t,this.ruleResolve()}return s(n,[{key:"ruleResolve",value:function(){var n=this;Object.keys(this.form.rules).forEach(function(e){var r=n.form.rules[e],t={};switch(!0){case"string"==typeof r:r.split("|").forEach(function(e){var r=e.split(":");t[r[0]]=!(1<r.length)||r[1]});break;case Array.isArray(r):r.forEach(function(e){var r=e.split(":");t[r[0]]=!(1<r.length)||r[1]});break;default:t=Object.assign({},r)}Object.keys(t).forEach(function(e){"string"==typeof t[e]&&(t[e]=t[e].split(",").slice(0))}),n.form.rules[e]=t})}}]),n}(),u={},l=function(){function l(e,r){o(this,l),this.form=r,this.errorBag=new a,this.vnode=e,this.scopes={}}return s(l,null,[{key:"rules",value:function(){return u}}]),s(l,[{key:"discoveryScope",value:function(u){var l=this,c=u.querySelectorAll("[data-vulidate-model]"),f=u.dataset.vulidateModel;(c.length||f)&&!Object.keys(this.scopes).length&&Object.keys(this.form).forEach(function(e){var r=l.form[e],t=!0,n=!1,i=void 0;try{for(var o,s=c[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var a=o.value;a.dataset.vulidateModel===e&&(l.scopes[e]=new h(r,a,l.vnode.$data[e]))}}catch(e){n=!0,i=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw i}}f===e&&(l.scopes[e]=new h(r,u,l.vnode.$data[e]))})}},{key:"validate",value:function(e){switch(this.discoveryScope(this.vnode.$el),!0){case void 0!==e.target:return this.currentScope=this.getScope(e.target),this.currentScope?this.handler(this.scopes[this.currentScope]):null;case"string"==typeof e:return this.currentScope=this.scopes.hasOwnProperty(e)?e:null,this.currentScope?this.handler(this.scopes[this.currentScope]):null;default:return void(this.currentScope=null)}}},{key:"getScope",value:function(e){var r=e.dataset.vulidateModel;return r||("BODY"!==e.tagName?this.getScope(e.parentElement):null)}},{key:"messageResolver",value:function(e,r,t){return e.message&&e.message.hasOwnProperty(r)?e.message[r]:t}},{key:"fieldNameResolver",value:function(e,r){return e.nameDisplayed&&e.nameDisplayed.hasOwnProperty(r)?e.nameDisplayed[r]:r}},{key:"handler",value:function(s){var a=this;if(!s.data||!s.form.rules)throw c("Hello world");var u=s.form;this.errorBag.clear(this.currentScope),Object.keys(u.rules).forEach(function(i){var o=u.rules[i];Object.keys(o).forEach(function(e){var r=l.rules();if(r.hasOwnProperty(e)&&!r[e].validate(s.data[i],o[e],s.data)){var t=r[e].message(a.fieldNameResolver(u,i)),n=a.messageResolver(u,i,t);a.errorBag.append(new c(i,n,a.currentScope,e))}})}),this.fail(this.currentScope)||this.vnode[this.form[this.currentScope].action]()}},{key:"fail",value:function(e){return this.errorBag.any(e)}},{key:"passed",value:function(e){return!this.fail(e)}}],[{key:"rule",value:function(e,r){if(!r.hasOwnProperty("validate")||!r.hasOwnProperty("message"))throw"the validate and message is mandatory";u[e]=Object.assign({},r)}},{key:"hasRule",value:function(e){return u.hasOwnProperty(e)}},{key:"use",value:function(r){Object.keys(r).forEach(function(e){l.rule(e,r[e])})}}]),l}(),f={name:"vulidate-summary",props:{errors:{type:Array,default:[]}},render:function(r){if(this.errors.length)return r("div",this.errors.map(function(e){return r("div",e.message)}))}},d={beforeCreate:function(){var e=this;if(this.$options.$forms){this.$vulidator=new l(this,this.$options.$forms);var r=this.$options._base,t=this.$vulidator.errorBag;r.util.defineReactive(t,"errors",t.errors);var n=this.$options;n.computed||(n.computed={}),n.computed.errors=function(){return e.$vulidator.errorBag.errors}}},methods:{$validate:function(){var e;if(this.$vulidator)return(e=this.$vulidator).validate.apply(e,arguments)}}},v={required:{validate:function(e){return Array.isArray(e)?!!e.length:null!=e&&("symbol"!==n(e)&&!!String(e).trim().length)},message:function(e){return"The ".concat(e," field is required")}},email:{validate:function(e){return/(^$|^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$)/.test(e)},message:function(e){return"The ".concat(e," field must be email")}},min:{validate:function(e,r){return e.length>r},message:function(e){return"this ".concat(e," must more than xx")}}};l.use(v);var p={install:function(e){e.mixin(d),e.directive("vul-show-error",t),e.component("vulidate-error",r),e.component("vulidate-summary",f)}};e.Vulidator=l,e.default=p,Object.defineProperty(e,"__esModule",{value:!0})});